<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>TV Smart Filter</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body { margin: 0; background: #000; color: #fff; font-family: sans-serif; }
        #menu { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #111; z-index: 100; overflow-y: scroll; }
        .ch { padding: 18px; border-bottom: 1px solid #333; font-size: 22px; cursor: pointer; }
        video { position: fixed; top: 0; left: 0; width: 100%; height: 100%; }
        #back-btn { position: fixed; bottom: 20px; right: 20px; z-index: 200; background: #e50914; color: #fff; border: none; padding: 15px; border-radius: 5px; font-weight: bold; display: none; }
    </style>
</head>
<body>

    <div id="menu">
        <div style="padding: 20px; color: #00ff00; font-weight: bold; border-bottom: 2px solid #222;">
            üì∫ DANH S√ÅCH K√äNH ƒê√É L·ªåC
        </div>
        <div id="list">ƒêang l·ªçc k√™nh...</div>
    </div>

    <button id="back-btn" onclick="showMenu()">ƒê·ªîI K√äNH</button>
    <video id="v" controls playsinline></video>

    <script>
        const M3U_URL = 'https://raw.githubusercontent.com/minhtan001/IPTV-Auto/refs/heads/playlists/all.m3u';
        
        // --- C·∫§U H√åNH B·ªò L·ªåC T·∫†I ƒê√ÇY ---
        // Ch·ªâ hi·ªán c√°c k√™nh c√≥ t√™n ch·ª©a m·ªôt trong c√°c ch·ªØ d∆∞·ªõi ƒë√¢y (vi·∫øt th∆∞·ªùng)
        const MY_KEYWORDS = ['vs']; 

        const v = document.getElementById('v');
        const list = document.getElementById('list');
        const menu = document.getElementById('menu');
        const btn = document.getElementById('back-btn');

        async function load() {
            try {
                const res = await fetch(M3U_URL);
                const text = await res.text();
                const lines = text.split('\n');
                let html = '';
                let count = 0;
                
                for (let i = 0; i < lines.length; i++) {
                    if (lines[i].includes('#EXTINF')) {
                        let name = lines[i].split(',')[1] || "";
                        let url = lines[i+1]?.trim();
                        
                        // KI·ªÇM TRA B·ªò L·ªåC
                        const nameLower = name.toLowerCase();
                        const isMatch = MY_KEYWORDS.some(key => nameLower.includes(key));

                        if (isMatch && url && url.startsWith('http')) {
                            html += `<div class="ch" onclick="play('${url}')">${name}</div>`;
                            count++;
                        }
                    }
                }
                list.innerHTML = html || '<div class="ch">Kh√¥ng t√¨m th·∫•y k√™nh ph√π h·ª£p!</div>';
            } catch (e) { list.innerHTML = '<div class="ch">L·ªói k·∫øt n·ªëi link M3U!</div>'; }
        }

        function play(url) {
            menu.style.display = 'none';
            btn.style.display = 'block';
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(v);
            } else { v.src = url; }
            v.play();
        }

        function showMenu() {
            v.pause();
            menu.style.display = 'block';
            btn.style.display = 'none';
        }

        load();
    </script>
</body>
</html>
